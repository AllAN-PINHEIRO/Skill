{% load static %}
<div class="animate-fade-in">

    <div class="mb-4">
        <h3 class="fw-bold mb-0">üëã Ol√°, {{ dados.nome }}!</h3>
        <p class="text-muted">Bem-vindo ao seu painel do Conecta IFBA.</p>
    </div>

    <div class="row g-4 mb-5">
        <div class="col-md-4">
            <div class="modern-card nav-card h-100 d-flex flex-column align-items-center justify-content-center p-4 hover-lift cursor-pointer" 
                 onclick="SPA.load('meu-perfil')">
                <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" 
                     class="nav-card-img mb-3" style="width: 60px; height: 60px;" alt="Perfil">
                <h5 class="fw-bold mb-0 text-dark">Meu Perfil</h5>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="modern-card nav-card h-100 d-flex flex-column align-items-center justify-content-center p-4 hover-lift cursor-pointer" 
                 onclick="SPA.load('vagas')">
                <img src="https://cdn-icons-png.flaticon.com/512/3281/3281329.png" 
                     class="nav-card-img mb-3" style="width: 60px; height: 60px;" alt="Vagas">
                <h5 class="fw-bold mb-0 text-dark">Mural de Vagas</h5>
            </div>
        </div>

        <div class="col-md-4">
            <div class="modern-card nav-card h-100 d-flex flex-column align-items-center justify-content-center p-4 hover-lift cursor-pointer"
                 onclick="SPA.load('grade')">
                <img src="https://cdn-icons-png.flaticon.com/512/3652/3652191.png" 
                     class="nav-card-img mb-3" style="width: 60px; height: 60px;" alt="Grade">
                <h5 class="fw-bold mb-0 text-dark">Minha Grade</h5>
            </div>
        </div>
    </div>

    <div class="row g-4">
        
        <div class="col-lg-6">
            <div class="section-header d-flex justify-content-between align-items-center mb-3">
                <h5 class="fw-bold mb-0"><i class="bi bi-pie-chart-fill text-success me-2"></i> √çndice de Skills</h5>
                <a href="#" class="section-link text-decoration-none small" onclick="SPA.load('meu-perfil'); return false;">
                    Detalhes <i class="bi bi-chevron-right"></i>
                </a>
            </div>

            <div class="modern-card p-3 h-100 border rounded-4 shadow-sm bg-white"> 
                {% if tem_skills %}
                    <div class="d-flex align-items-center h-100">
                        
                        <div style="flex: 0 0 50%; height: 220px; position: relative;">
                            <canvas id="skillsChart"></canvas>
                        </div>

                        <div id="custom-chart-legend" 
                             class="ps-3 d-flex flex-column gap-2 custom-scroll pe-2" 
                             style="flex: 1; overflow-y: auto; max-height: 220px;">
                            </div>

                    </div>
                    
                    <script id="chart-labels" type="application/json">{{ skill_labels|safe }}</script>
                    <script id="chart-data" type="application/json">{{ skill_data|safe }}</script>

                    <script>
                        setTimeout(() => {
                            if(typeof initSkillsChart === 'function') initSkillsChart();
                        }, 300);
                    </script>

                {% else %}
                    <div class="text-center py-5">
                        <i class="bi bi-bar-chart-line text-muted opacity-25 display-1"></i>
                        <h6 class="mt-3 text-muted fw-bold">Sem dados</h6>
                        <p class="small text-muted mb-4">Cadastre suas skills para visualizar o √≠ndice.</p>
                        <button class="btn btn-sm btn-outline-success rounded-pill px-4" onclick="SPA.load('meu-perfil')">
                            Cadastrar Agora
                        </button>
                    </div>
                {% endif %}
            </div>
        </div>

        <div class="col-lg-6">
            <div class="section-header d-flex justify-content-between align-items-center mb-3">
                <h5 class="fw-bold mb-0"><i class="bi bi-briefcase-fill text-primary me-2"></i> Vagas Recentes</h5>
                <a href="#" class="section-link text-decoration-none small" onclick="SPA.load('vagas'); return false;">
                    Ver todas <i class="bi bi-chevron-right"></i>
                </a>
            </div>

            <div class="d-flex flex-column gap-3" style="min-height: 280px;">
                
                {% for vaga in vagas_recentes %}
                <div class="vaga-card-modern bg-white p-3 border rounded shadow-sm hover-lift cursor-pointer" onclick="SPA.load('vagas')">
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <h6 class="fw-bold mb-1 text-dark">{{ vaga.titulo }}</h6>
                            <p class="text-muted small mb-1">{{ vaga.empresa }}</p>
                            
                            {% if vaga.match_percent == 100 %}
                                <small class="text-success fw-bold"><i class="bi bi-stars"></i> 100% Match</small>
                            {% else %}
                                <small class="text-primary fw-bold"><i class="bi bi-check-circle"></i> {{ vaga.match_percent }}% Match</small>
                            {% endif %}
                        </div>
                        
                        {% if vaga.modalidade == 'REMOTO' %}
                            <span class="badge bg-info-subtle text-info border border-info-subtle rounded-pill">Remoto</span>
                        {% elif vaga.modalidade == 'HIBRIDO' %}
                            <span class="badge bg-warning-subtle text-warning border border-warning-subtle rounded-pill">H√≠brido</span>
                        {% else %}
                            <span class="badge bg-secondary-subtle text-secondary border border-secondary-subtle rounded-pill">Presencial</span>
                        {% endif %}
                    </div>
                </div>
                {% empty %}
                <div class="text-center py-5 bg-light rounded-3 border border-dashed">
                    <i class="bi bi-search text-muted fs-3 mb-2"></i>
                    <p class="text-muted small mb-0 fw-bold">Nenhuma vaga compat√≠vel.</p>
                    <p class="text-muted mb-0" style="font-size: 0.7rem;">Adicione skills para receber recomenda√ß√µes.</p>
                </div>
                {% endfor %}

            </div>
        </div>

    </div>
</div>